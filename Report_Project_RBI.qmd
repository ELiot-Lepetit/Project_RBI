---
title: "Investigating the Interplay Between Socio-Demographic Indicators and Net State Domestic Product (NSDP) Across Indian States"
author: "Aashish Sukhija & Eliot Lepetit"
format: 
  html: default
  pdf: default
editor: 
  markdown: 
    wrap: sentence
---


```{r}
#| message: false
#| warning: false
#| echo: false
here::i_am("Project_RBI.Rproj")
library(here)       
library(readxl)     
library(tidyr)  
library(stringr)
library(dplyr)
library(vroom)
library(readr)
library(knitr)
library(ggplot2)
library(janitor)
library(purrr)
theme_set(theme_bw())
```

```{r}
#| echo: false
suppressMessages({
Literacy_data <- read.csv(here("data", "State-wise_Literacy_Rate.csv"))
Birth_data <- read.csv(here("data", "State-wise_Birth_Rate.csv"))
Sex_data <- read.csv(here("data", "State-wise_Sex_Ratio.csv"))
Death_data <- read.csv(here("data", "State-wise_Death_Rate.csv"))
Pop_data <- read.csv(here("data", "State-wise_Total_Population.csv"))
IMR_data <- read.csv(here("data", "State-wise_Infant_Mortality_Rate.csv"))
TFR_data <- read.csv(here("data", "State-wise_Total_Fertility_Rate.csv"))
Life_data <- read.csv(here("data", "State-wise_Life_Expectancy.csv"))
Health_Exp_data <- read.csv(here("data", "State-wise_Public_Expenditure_on_Health.csv"))
NSDP1_data <- read.csv(here("data", "Net_State_Domestic_Product_1.csv"))
NSDP2_data <- read.csv(here("data", "Net_State_Domestic_Product_2.csv"))
NSDP3_data <- read.csv(here("data", "Net_State_Domestic_Product_3.csv"))
}) 
```


# I) Research Question
India’s diversity in economic and social conditions makes it an ideal case for studying the interplay between economic and demographic factors. High-performing states benefit from robust health and education systems, while underperforming states struggle due to insufficient investments in human capital. Moreover, understanding the impact of cultural and geographic differences adds a unique layer to the analysis. For instance, northeastern states may face challenges due to geographic isolation, while southern states may excel due to better health and education policies. Hence, our project aims to investigate the intricate relationship between socio-demographic indicators and economic performance at the state level in India.

**How do socio-demographic indicators, such as literacy rate, health expenditure, and birth rate, interact with the Net State Domestic Product (NSDP) across Indian states, and how do these interactions explain regional disparities in economic and social development?:**

To address this research question, we propose two sets of hypotheses which aim to uncover key drivers of regional disparities and shed light on the connections between economic performance and social development across Indian states.


## Hypotheses

#### Block 1: Health Expenditure and NSDP
1. States with higher NSDP allocate greater health expenditure per capita due to higher fiscal capacity.
   
   1.1. Higher health expenditure is associated with lower infant mortality rates and lower death rates.

#### Block 2: Literacy Rate and NSDP
2. States with higher NSDP tend to have higher literacy rates. Literacy is used as a proxy for education in this analysis.
  
   2.1. Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.
  
   2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.
   
This hypothesis is supported by extensive literature. For instance, Frank Götmark and Malte Andersson, in their article _Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs_, demonstrate that 'fertility (TFR) correlates negatively with education^[Götmark, F., Andersson, M. Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs. BMC Public Health, 20, 265 (2020).]'. 


## Objectives of the Research

To summarize, this project aims to explore the relationship between socio-demographic indicators and economic performance across Indian states, focusing on:

1. **Regional Disparities**:
   - Analyze differences in NSDP across states and identify factors driving these disparities.

2. **Role of Socio-Demographic Indicators**:
   - Investigate the correlation between NSDP and variables like literacy rates, health expenditure, and birth/death rates.

3. **Regional Comparisons**:
   - Examine how geographic and cultural factors shape economic and social outcomes.

To achieve these objectives, we rely on datasets that provide insights into both socio-demographic factors and economic performance across Indian states.


# II) Data sets desctiption

## Data Sources
1. [Handbook of Statistics on Indian States](https://www.rbi.org.in/Scripts/AnnualPublications.aspx?head=Handbook+of+Statistics+on+Indian+States)
2. [Net State Domestic Product - State-wise (At Constant Prices)](https://www.rbi.org.in/Scripts/PublicationsView.aspx?id=22480)
 
---

### 1. Socio-Demographic Indicators
The socio-demographic data is sourced from the Handbook of Statistics on Indian States (2022-2023) by the Reserve Bank of India. This dataset provides insights into health, education, and population dynamics across India’s 28 states and 8 Union territories.

**Key Indicators:**
- Literacy Rate: Proportion of the population aged 7+ who can read and write.
- Birth Rate: Number of live births per 1,000 people annually.
- Death Rate: Number of deaths per 1,000 people annually.
- Sex Ratio: Number of females per 1,000 males.
- Total Population: Census-based state population projections.
- Infant Mortality Rate (IMR): Infant deaths per 1,000 live births.
- Total Fertility Rate (TFR): Average number of children per woman.
- Life Expectancy: Average years a person is expected to live.
- Public Health Expenditure: State-level spending on healthcare.

These indicators provide a socio-demographic lens to explore human development and its interaction with economic growth.


### 2. Net State Domestic Product (NSDP)
The NSDP data is derived from the RBI’s State-wise Economic Indicators. It reflects state-level economic output at constant prices, allowing comparisons over time by adjusting for inflation.

**Key Features:**
- Measures total economic value generated within each state.
- Disaggregated by sectors: agriculture, industry, and services.
- Organized by fiscal years to track growth trajectories.

NSDP serves as a benchmark for economic performance, offering insights into regional disparities and the structural composition of state economies.


## Why These Datasets?
These datasets are ideal for studying the interplay between socio-demographic factors and economic performance. While NSDP highlights economic output, socio-demographic indicators provide context for human capital and health conditions. Together, they allow for a robust analysis of regional disparities, uncovering patterns and trends that drive development outcomes across Indian states.


```{r}
#| message: false
#| warning: false
#| echo: false

# State-wise Birth Rate
Birth_data <- Birth_data %>%  rename(State = State.Union.Territory ) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>% 
    slice(-c(39, 40)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Death Rate
Death_data <- Death_data %>%  rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(39, 40)) %>%
   mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Public Expenditure on Health
Health_Exp_data <- Health_Exp_data %>%
  rename(State = `State.Union.Territory`) %>%                   
  rename_with(~ gsub("^X|\\..*", "", .)) %>%                     
  mutate(across(-State, as.numeric)) %>%                        
  mutate(across(where(is.numeric), ~ round(., 1))) %>%           
  slice(-c(37, 38))                                             

# State-wise Literacy Rate
Literacy_data <- Literacy_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) %>%
  slice(-c(37:40))

# State-wise Total Population
Pop_data <- Pop_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:43)) %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .)))

# State-wise Sex Ratio
Sex_data <- Sex_data %>% rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:39))  %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  select(-`1951`)  

# State-wise Total Fertility Rate
TFR_data <- TFR_data %>%  rename(State = `Year`) %>%
    rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(24:26)) %>%
   mutate(across(where(is.numeric), ~ round(., 1)))

# Infant Mortality Rate
IMR_data <- IMR_data %>%
  row_to_names(row_number = 1) %>%
  slice(-c(38:41)) %>%
  rename(State = `State/Union Territory`) %>%
  mutate(across(-State, ~ as.numeric(gsub("\\*", "", .))))

```


```{r}
#| message: false
#| warning: false
#| echo: false
NSDP_merged <- NSDP1_data %>%
  full_join(NSDP2_data, by = "Year") %>%
  full_join(NSDP3_data, by = "Year")

# Removing unused rows (we keep the data only for years after 2011)
NSDP_merged <- NSDP_merged[c(11:16, 25:29, 38:44, 53:65), ] 

# Transforming missing values character as "NAs" and changing the dates format
NSDP_merged <- NSDP_merged %>% 
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  mutate(Year = as.numeric(sub("-.*", "", Year)))

# We pivot the database to have a variable "State" in order to merge with other datasets
NSDP_long <- NSDP_merged %>%
  mutate(across(-Year, as.character)) %>%
  pivot_longer(
    cols = -Year,         
    names_to = "State",    
    values_to = "Value"     
  ) 

# Clean and arrange the State variable in alphabetical order and replace specific names
NSDP_clean <- NSDP_long %>%
  pivot_wider(
    names_from = Year,     
    values_from = Value
  )  %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(
    State = gsub("\\.+", " ", State),                        # Replace "." with " "
    State = case_when(
      State == "Andaman Nicobar Islands" ~ "Andaman & Nicobar Islands", # Fix specific name
      State == "Jammu Kashmir" ~ "Jammu & Kashmir",                     # Fix Jammu Kashmir
      TRUE ~ State                                                    # Keep other names as is
    )
  ) %>%
  arrange(State)  # Sort by State in alphabetical order

rm(NSDP1_data, NSDP2_data, NSDP3_data)

```


```{r}
#| message: false
#| warning: false
#| echo: false
datasets <- list(
  Literacy_data, Birth_data, Sex_data, Death_data, Pop_data, Health_Exp_data, NSDP_clean, TFR_data, IMR_data
)

# Names of the datasets
dataset_names <- c(
  "Literacy Rate", "Birth Rate", "Sex Ratio", "Death Rate", "Population", "Health Expenditure", 
  "NSDP", "Total Fertility Rate", "Infant Mortality Rate"
)

# Preprocessing function
preprocess_dataset <- function(data) {
  data %>%
    {if (any(grepl("State", colnames(.)))) rename(., State = starts_with("State")) else .} %>% # Rename State if it exists
    rename_with(~ gsub("^X", "", .), -State) %>%    # Remove "X" prefix from year columns
    {if ("1951" %in% colnames(.)) select(., -`1951`) else .} %>% # Remove "1951" if it exists
    mutate(across(-State, as.character))           # Ensure all year columns are character
}

# Apply preprocessing to all datasets
datasets <- map(datasets, preprocess_dataset)

# Convert each dataset to long format
long_datasets <- map2(datasets, dataset_names, function(data, name) {
  data %>%
    pivot_longer(
      cols = -State,                
      names_to = "Year",           
      values_to = name              
    ) %>%
    mutate(Year = as.numeric(Year)) 
})

# Merge all long-format datasets by "State" and "Year"
merged_data <- reduce(long_datasets, full_join, by = c("State", "Year"))
```


After merging all the datasets, we observed missing values across certain years, as not all demographic variables are consistently available for every year in the RBI datasets. To address this, we selected specific years for each hypothesis: **2019** for the first and **2011** for the second.


<div style="display: flex; justify-content: space-between;">

<div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2019 <- merged_data %>%
  filter(State != "ALL INDIA") %>%
  filter(Year == 2019) %>%
  select(State, Year, NSDP, `Health Expenditure`, `Death Rate`, `Birth Rate`, `Infant Mortality Rate`) %>%
  head(5)

knitr::kable(table_2019, caption = "Data for Hypothese 1", align = "c")
```
</div> <div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2011 <- merged_data %>%
  filter(Year == 2011) %>%
  select(State, Year, NSDP, `Literacy Rate`, `Birth Rate`, `Sex Ratio`, `Death Rate`, `Infant Mortality Rate`) %>%
  head(5)

knitr::kable(table_2011, caption = "Data for Hypothese 2", align = "c")
```

</div> </div>


