---
title: "Investigating the Interplay Between Socio-Demographic Indicators and Net State Domestic Product (NSDP) Across Indian States"
author: "Aashish Sukhija & Eliot Lepetit"
format: 
  html: default
  pdf: default
editor: 
  markdown: 
    wrap: sentence
---

```{r}
#| message: false
#| warning: false
#| echo: false
here::i_am("Project_RBI.Rproj")
library(here)       
library(readxl)     
library(tidyr)  
library(stringr)
library(dplyr)
library(vroom)
library(readr)
library(knitr)
library(ggplot2)
library(janitor)
library(purrr)
library(kableExtra)
library(ggrepel) 
theme_set(theme_bw())
```

```{r}
#| echo: false
suppressMessages({
Literacy_data <- read.csv(here("data_final", "State-wise_Literacy_Rate.csv"))
Birth_data <- read.csv(here("data_final", "State-wise_Birth_Rate.csv"))
Sex_data <- read.csv(here("data_final", "State-wise_Sex_Ratio.csv"))
Death_data <- read.csv(here("data_final", "State-wise_Death_Rate.csv"))
Pop_data <- read.csv(here("data_final", "State-wise_Total_Population.csv"))
IMR_data <- read.csv(here("data_final", "State-wise_Infant_Mortality_Rate.csv"))
TFR_data <- read.csv(here("data_final", "State-wise_Total_Fertility_Rate.csv"))
Life_data <- read.csv(here("data_final", "State-wise_Life_Expectancy.csv"))
Health_Exp_data <- read.csv(here("data_final", "State-wise_Public_Expenditure_on_Health.csv"))
NSDP1_data <- read.csv(here("data_final", "Net_State_Domestic_Product_1.csv"))
NSDP2_data <- read.csv(here("data_final", "Net_State_Domestic_Product_2.csv"))
NSDP3_data <- read.csv(here("data_final", "Net_State_Domestic_Product_3.csv"))
Pop_data_2019 <- read.csv(here("data_final", "state_wise_population__2019.csv"))
}) 
```


# I) Research Question
India’s diversity in economic and social conditions makes it an ideal case for studying the interplay between economic and demographic factors. High-performing states benefit from robust health and education systems, while underperforming states struggle due to insufficient investments in human capital. Moreover, understanding the impact of cultural and geographic differences adds a unique layer to the analysis. For instance, northeastern states may face challenges due to geographic isolation, while southern states may excel due to better health and education policies. Hence, our project aims to investigate the intricate relationship between socio-demographic indicators and economic performance at the state level in India.

**How do socio-demographic indicators, such as literacy rate, health expenditure, and birth rate, interact with the Net State Domestic Product (NSDP) across Indian states, and how do these interactions explain regional disparities in economic and social development?:**

To address this research question, we propose two sets of hypothesis which aim to uncover key drivers of regional disparities and shed light on the connections between economic performance and social development across Indian states.


## Hypothesis

#### Block 1: Health Expenditure and NSDP
1. States with higher NSDP allocate greater health expenditure per capita due to higher fiscal capacity.
   
   1.1. Higher health expenditure is associated with lower infant mortality rates and lower death rates.

#### Block 2: Literacy Rate and NSDP
2. States with higher NSDP tend to have higher literacy rates. Literacy is used as a proxy for education in this analysis.
  
   2.1. Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.
  
   2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.
   
This hypothesis is supported by extensive literature. For instance, Frank Götmark and Malte Andersson, in their article _Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs_, demonstrate that 'fertility (TFR) correlates negatively with education^[Götmark, F., Andersson, M. Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs. BMC Public Health, 20, 265 (2020).]'. 


## Objectives of the Research

To summarize, this project aims to explore the relationship between socio-demographic indicators and economic performance across Indian states, focusing on:

1. **Regional Disparities**:
   - Analyze differences in NSDP across states and identify factors driving these disparities.

2. **Role of Socio-Demographic Indicators**:
   - Investigate the correlation between NSDP and variables like literacy rates, health expenditure, and birth/death rates.

3. **Regional Comparisons**:
   - Examine how geographic and cultural factors shape economic and social outcomes.

To achieve these objectives, we rely on datasets that provide insights into both socio-demographic factors and economic performance across Indian states.


# II) Data sets desctiption

## Data Sources
1. [Handbook of Statistics on Indian States](https://www.rbi.org.in/Scripts/AnnualPublications.aspx?head=Handbook+of+Statistics+on+Indian+States)
2. [Net State Domestic Product - State-wise (At Constant Prices)](https://www.rbi.org.in/Scripts/PublicationsView.aspx?id=22480)
3. [Indian population (by states) in 2019](https://www.kaggle.com/datasets/sureshraj256/india-state-population?resource=download)
---

### 1. Socio-Demographic Indicators
The socio-demographic data is sourced from the Handbook of Statistics on Indian States (2022-2023) by the Reserve Bank of India. This dataset provides insights into health, education, and population dynamics across India’s 28 states and 8 Union territories.

**Key Indicators:**
- Literacy Rate: Proportion of the population aged 7+ who can read and write.
- Birth Rate: Number of live births per 1,000 people annually.
- Death Rate: Number of deaths per 1,000 people annually.
- Sex Ratio: Number of females per 1,000 males.
- Total Population: Census-based state population projections. 
- Infant Mortality Rate (IMR): Infant deaths per 1,000 live births.
- Total Fertility Rate (TFR): Average number of children per woman.
- Life Expectancy: Average years a person is expected to live.
- Public Health Expenditure: State-level spending on healthcare.

These indicators provide a socio-demographic lens to explore human development and its interaction with economic growth.


### 2. Net State Domestic Product (NSDP)
The NSDP data is derived from the RBI’s State-wise Economic Indicators. It reflects state-level economic output at constant prices, allowing comparisons over time by adjusting for inflation.

**Key Features:**
- Measures total economic value generated within each state.
- Disaggregated by sectors: agriculture, industry, and services.
- Organized by fiscal years to track growth trajectories.

NSDP serves as a benchmark for economic performance, offering insights into regional disparities and the structural composition of state economies.


## Why These Datasets?
These datasets are ideal for studying the interplay between socio-demographic factors and economic performance. While NSDP highlights economic output, socio-demographic indicators provide context for human capital and health conditions. Together, they allow for a robust analysis of regional disparities, uncovering patterns and trends that drive development outcomes across Indian states.


```{r}
#| message: false
#| warning: false
#| echo: false

# State-wise Birth Rate
Birth_data <- Birth_data %>%  rename(State = State.Union.Territory ) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>% 
    slice(-c(39, 40)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Death Rate
Death_data <- Death_data %>%  rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(39, 40)) %>%
   mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Public Expenditure on Health
Health_Exp_data <- Health_Exp_data %>%
  rename(State = `State.Union.Territory`) %>%                   
  rename_with(~ gsub("^X|\\..*", "", .)) %>%                     
  mutate(across(-State, as.numeric)) %>%                        
  mutate(across(where(is.numeric), ~ round(., 1))) %>%           
  slice(-c(37, 38))                                             

# State-wise Literacy Rate
Literacy_data <- Literacy_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) %>%
  slice(-c(37:40))

# State-wise Total Population
Pop_data <- Pop_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:43)) %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .)))

# State-wise Sex Ratio
Sex_data <- Sex_data %>% rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:39))  %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  select(-`1951`)  

# State-wise Total Fertility Rate
TFR_data <- TFR_data %>%  rename(State = `Year`) %>%
    rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(24:26)) %>%
   mutate(across(where(is.numeric), ~ round(., 1)))

# Infant Mortality Rate
IMR_data <- IMR_data %>%
  row_to_names(row_number = 1) %>%
  slice(-c(38:41)) %>%
  rename(State = `State/Union Territory`) %>%
  mutate(across(-State, ~ as.numeric(gsub("\\*", "", .))))

#population_data
Pop_data_2019 <- Pop_data_2019 %>%
  select(State, total_population) %>%
  arrange(State)

```


```{r}
#| message: false
#| warning: false
#| echo: false
NSDP_merged <- NSDP1_data %>%
  full_join(NSDP2_data, by = "Year") %>%
  full_join(NSDP3_data, by = "Year")

# Removing unused rows (we keep the data only for years after 2011)
NSDP_merged <- NSDP_merged[c(11:16, 25:29, 38:44, 53:65), ] 

# Transforming missing values character as "NAs" and changing the dates format
NSDP_merged <- NSDP_merged %>% 
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  mutate(Year = as.numeric(sub("-.*", "", Year)))

# We pivot the database to have a variable "State" in order to merge with other datasets
NSDP_long <- NSDP_merged %>%
  mutate(across(-Year, as.character)) %>%
  pivot_longer(
    cols = -Year,         
    names_to = "State",    
    values_to = "Value"     
  ) 

# Clean and arrange the State variable in alphabetical order and replace specific names
NSDP_clean <- NSDP_long %>%
  pivot_wider(
    names_from = Year,     
    values_from = Value
  )  %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(
    State = gsub("\\.+", " ", State),                        # Replace "." with " "
    State = case_when(
      State == "Andaman Nicobar Islands" ~ "Andaman & Nicobar Islands", # Fix specific name
      State == "Jammu Kashmir" ~ "Jammu & Kashmir",                     # Fix Jammu Kashmir
      TRUE ~ State                                                    # Keep other names as is
    )
  ) %>%
  arrange(State)  # Sort by State in alphabetical order

rm(NSDP1_data, NSDP2_data, NSDP3_data)

```


```{r}
#| message: false
#| warning: false
#| echo: false
datasets <- list(
  Literacy_data, Birth_data, Sex_data, Death_data, Pop_data, Health_Exp_data, NSDP_clean, TFR_data, IMR_data
)

# Names of the datasets
dataset_names <- c(
  "Literacy Rate", "Birth Rate", "Sex Ratio", "Death Rate", "Population", "Health Expenditure", 
  "NSDP", "Total Fertility Rate", "Infant Mortality Rate"
)

# Preprocessing function
preprocess_dataset <- function(data) {
  data %>%
    {if (any(grepl("State", colnames(.)))) rename(., State = starts_with("State")) else .} %>% # Rename State if it exists
    rename_with(~ gsub("^X", "", .), -State) %>%    # Remove "X" prefix from year columns
    {if ("1951" %in% colnames(.)) select(., -`1951`) else .} %>% # Remove "1951" if it exists
    mutate(across(-State, as.character))           # Ensure all year columns are character
}

# Apply preprocessing to all datasets
datasets <- map(datasets, preprocess_dataset)

# Convert each dataset to long format
long_datasets <- map2(datasets, dataset_names, function(data, name) {
  data %>%
    pivot_longer(
      cols = -State,                
      names_to = "Year",           
      values_to = name              
    ) %>%
    mutate(Year = as.numeric(Year)) 
})

# Merge all long-format datasets by "State" and "Year"
merged_data <- reduce(long_datasets, full_join, by = c("State", "Year"))
```


After merging all the datasets, we observed missing values across certain years, as not all demographic variables are consistently available for every year in the RBI datasets. To address this, we selected specific years for each hypothesis: **2019** for the first and **2011** for the second.


```{r,, results='hide'}
#| message: false
#| warning: false
#| echo: false

### Adding the population variable

merged_data_2019 <- merged_data %>%
  filter(Year == 2019) %>%
  filter(State != "ALL INDIA") %>%
  mutate(mutate(across(-c(State, Year), as.numeric))) %>%
  select(!c(`Literacy Rate`, `Sex Ratio`))

merged_data_2019_clean <- merged_data_2019 %>%
  filter(!is.na(`NSDP`), !is.na(`Health Expenditure`))  %>%
  filter(!State %in% c("Arunachal Pradesh")) %>%
  arrange(State)

Filter_data_2019 <- merged_data_2019_clean %>%
  filter(State %in% c("Maharashtra", "Karnataka","Odisha", "Punjab", "Rajasthan", "Assam")) %>%
  filter(Year == 2019) 

# Select specific columns for the hypothesis
Filter_data_2019 <- Filter_data_2019 %>% select(State, Year, NSDP, `Health Expenditure`, Population, `Death Rate`,`Infant Mortality Rate`)

# Check the structure of the dataset
str(Filter_data_2019)

# Convert the observations to numeric 
Filter_data_2019 <- Filter_data_2019 |> 
  mutate(
    NSDP = as.numeric(NSDP), 
    `Health Expenditure` = as.numeric(`Health Expenditure`), 
    `Death Rate` = as.numeric(`Death Rate`),
    `Infant Mortality Rate` = as.numeric(`Infant Mortality Rate`)
  )

# Preparing the add of the population variable by merging
Pop_data_2019 <- Pop_data_2019 %>%
  filter(!State %in% c("ANDAMAN & NICOBAR ISLANDS", "CHANDIGARH", "DNH", "TAMIL NADU")) %>%
  arrange(State)

# Merging
merged_data_2019_clean <- merged_data_2019_clean %>%
  mutate(Population = Pop_data_2019$total_population) %>%
  filter(State != "Himachal Pradesh") #remove outlier 

#Creating a "health expenditure PER CAPITA" variable 

merged_data_2019_clean <- merged_data_2019_clean %>%
mutate(`Health Expenditure Per Capita` = (`Health Expenditure` * 1e7 / Population)) # Convert ₹ crore to ₹ (Indian Rupees)


# Creatin a "NSDP per capita" variable
merged_data_2019_clean <- merged_data_2019_clean %>%
mutate(`NSDP Per Capita` = (NSDP * 1e7 / Population)) # Convert ₹ crore to ₹ (Indian Rupees)

```

<div style="display: flex; justify-content: space-between;">

<div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2019 <- merged_data_2019_clean %>%
  select(-c(`Birth Rate`, `Total Fertility Rate`)) %>% 
  filter(State != "Chhattisgarh") %>%
  head(5) %>% 
  mutate(`Health Expenditure Per Capita` = round(`Health Expenditure Per Capita`, 1))

knitr::kable(table_2019, caption = "Data for Hypothesis 1", align = "c")

```
</div> <div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2011 <- merged_data %>%
  filter(Year == 2011) %>%
  select(State, Year, NSDP, `Literacy Rate`, `Birth Rate`, `Sex Ratio`, `Death Rate`, `Infant Mortality Rate`) %>%
  head(5)

knitr::kable(table_2011, caption = "Data for Hypothesis 2", align = "c")
```

</div> </div>


# III) Analysis

## Hypothesis 1 Analysis
1. States with higher NSDP allocate greater health expenditure per capita due to higher fiscal capacity.
   
   1.1. Higher health expenditure is associated with lower infant mortality rates and lower death rates.


To evaluate this hypothesis, we performed two analyses: 

- one using state-level aggregated values 

- and the other using per capita values. 

This approach captures both the overall resource allocation (state values) and the individual fiscal capacity (per capita values).

### State-level analysis

#### Generating a ggplot 

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(merged_data_2019_clean, aes(x = NSDP, y = `Health Expenditure`, color = State, size = Population / 1e6)) +
  geom_point(alpha = 0.6) +  
  geom_text_repel(aes(label = State), size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE, show.legend = FALSE) +  
  labs(
    title = "Relationship Between NSDP and Health Expenditure\n(per capita)",
    x = "NSDP per capita",
    y = "Health Expenditure (per capita)",
    size = "Population (in millions)"  
  ) +
  scale_size_continuous(range = c(1, 8)) +  
  theme_minimal() +
  guides(color = "none") +  
  theme(
    legend.position = "right"  
  )
```

#### Inference drawn from the graph:
1.	Positive Correlation: States with higher economic output per individual tend to allocate more resources to health on a per capita basis
2. Inferences about policy choices: Maharashtra stands out with both high NSDP and Health Expenditure, reflecting its strong fiscal capacity. Uttar Pradesh, however, has a relatively high Health Expenditure compared to its NSDP, suggesting that the state prioritizes health spending despite its lower economic capacity. This could indicate a deliberate policy focus on healthcare
3.	Clustering: Most states are clustered in the lower NSDP and Health Expenditure range, indicating limited fiscal capacity and health spending for the majority of states. These States (or Union Territories) may require targeted support to improve health expenditure despite their lower fiscal capacity.


```{r}
#| message: false
#| warning: false
#| echo: false

# Compute correlation
correlation <- cor(merged_data_2019_clean$NSDP, merged_data_2019_clean$`Health Expenditure`)

# Fit the linear regression model
model1 <- lm(`Health Expenditure` ~ NSDP, data = merged_data_2019_clean)
summary_model <- summary(model1)

# Extract key statistics from the regression
results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (NSDP)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                
    round(summary_model$coefficients[1, 1], 3),           
    round(summary_model$coefficients[2, 1], 6),           
    round(summary_model$r.squared, 3),                    
    round(summary_model$adj.r.squared, 3),                
    round(summary_model$coefficients[2, 4], 3)           
  )
)

kable(results_table, caption = "Summary of Correlation and Linear Regression Results")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  
  row_spec(0, align = "c")                                   
```
In this table, we examine the correlation and linear regression results to explore the relationship between NSDP (Net State Domestic Product) and Health Expenditure. 

#### Conclusion:
1.	Correlation: NSDP and Health Expenditure exhibit a strong positive correlation, with a coefficient of 0.854, indicating that states with higher NSDP tend to spend more on health.
2.	The analysis reveals that 73% of the variation in Health Expenditure is explained by NSDP (R-squared = 0.73), with a statistically significant relationship (p-value < 0.001), indicating that states with higher NSDP allocate more resources to health, although the modest slope (0.0101) suggests gradual increases in spending.

Thus, the state-level analysis highlights that states with higher NSDP are significantly more likely to allocate greater resources toward health. 


#### Limitations
1.  The analysis does not consider critical factors, such as state policies, healthcare infrastructure, or socio-economic disparities, which may also significantly impact health expenditure.
2.  The relationship is analyzed at the state level, which overlooks significant variations within states, such as **differences in population size** and resource allocation across regions. 

These limitations highlight the need for a per capita analysis, offering a more nuanced view of health expenditure relative to individual fiscal capacity and well-being by cancelling any population effect.

---

### Per-capita analysis

#### Generating a ggplot 

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(merged_data_2019_clean, aes(x = `NSDP Per Capita`, y = `Health Expenditure Per Capita`, size = Population / 1e6, color = State)) +
  geom_point(alpha = 0.6) +  # Adjust transparency of points
  geom_text_repel(aes(label = State), size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE, show.legend = FALSE) +  # Remove line from legend
  labs(
    title = "Relationship Between NSDP and Health Expenditure\n(per capita)",
    x = "NSDP per capita",
    y = "Health Expenditure (per capita)",
    size = "Population (in millions)"  
  ) +
  scale_size_continuous(range = c(1, 8)) +  
  theme_minimal() +
  guides(color = "none") +  
  theme(
    legend.position = "right"  
  )

```

#### Inference Drawn from the graph:
1.	Positive Correlation: The graph demonstrates a positive relationship between NSDP and Health Expenditure. States with higher NSDP allocate more resources toward health.
2.  Population effect: States with larger populations often face challenges in achieving high per capita health expenditure. Conversely, states like Nagaland and Meghalaya show that effective prioritization of health resources can result in higher per capita health expenditure, even with limited fiscal capacity.


```{r}
#| message: false
#| warning: false
#| echo: false

correlation <- cor(merged_data_2019_clean$`NSDP Per Capita`, merged_data_2019_clean$`Health Expenditure Per Capita`)

# Fit the linear regression model
model1 <- lm(`Health Expenditure Per Capita` ~ `NSDP Per Capita`, data = merged_data_2019_clean)
summary_model <- summary(model1)

# Extract key statistics from the regression
results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (NSDP)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                
    round(summary_model$coefficients[1, 1], 3),           
    round(summary_model$coefficients[2, 1], 6),           
    round(summary_model$r.squared, 3),                    
    round(summary_model$adj.r.squared, 3),                
    round(summary_model$coefficients[2, 4], 3)           
  )
)

kable(results_table, caption = "Overview of Correlation and Linear Regression Findings for the 'Per Capita' Analysis")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  
  row_spec(0, align = "c")                                   
```
In this table, we examine the correlation and linear regression results to explore the relationship between NSDP (Net State Domestic Product) and Health Expenditure. 

#### Conclusion:
1.	Correlation: The 'per capita' analysis results align closely with those of the state-level analysis.
2.	The lower R-squared in the per capita analysis indicates that total NSDP serves as a more robust predictor of health expenditure, reflecting the underlying influence of population size.

While both regressions indicate a significant positive relationship between fiscal capacity and health expenditure, the 'per capita' analysis offers deeper insight by emphasizing the impact of population size. States with larger populations face challenges in maintaining high per capita health spending, as seen in states like Uttar Pradesh and Bihar. Conversely, smaller states like Nagaland and Meghalaya manage higher per capita health expenditures despite moderate fiscal capacity, showcasing the role of policy prioritization.

---

Hypothesis 1.1. Higher health expenditure is associated with lower infant mortality rates and lower death rates.

#### Generating ggplots for our two assumptions

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false

# Health Expenditure Per Capita vs Infant Mortality Rate
ggplot(merged_data_2019_clean, aes(x = `Health Expenditure Per Capita`, y = `Infant Mortality Rate`, color = State)) +
  geom_point(color = "blue", alpha = 0.7) +
    geom_text_repel(aes(label = State), size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +
  labs(
    title = "Relationship Between Health Expenditure and\nInfant Mortality Rate",
    x = "Health Expenditure Per Capita",
    y = "Infant Mortality Rate"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

# Health Expenditure Per Capita vs Death Rate
ggplot(merged_data_2019_clean, aes(x = `Health Expenditure Per Capita`, y = `Death Rate`, color = State)) +
  geom_point(color = "darkgreen", alpha = 0.7) +
    geom_text_repel(aes(label = State), size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +
  labs(
    title = "Relationship Between Health Expenditure and Death Rate",
    x = "Health Expenditure Per Capita",
    y = "Death Rate"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```


#### Inference Drawn from the graph:
1.	Negative Correlations: The regression lines indicate a slight negative relationship in both cases.
2.  Weak Relationahsip: States with similar levels of health expenditure per capita display significant variation in death rates. This indicates that factors such as healthcare quality, public health policies, and demographic characteristics may heavily influence death rates, making it difficult to draw strong conclusions from expenditure levels alone.





--- 

## Hypothesis 2 Analysis
2. States with higher NSDP tend to have higher literacy rates. Literacy is used as a proxy for education in this analysis.
  
   2.1. Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.
  
   2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.


```{r,, results='hide'}
#| message: false
#| warning: false
#| echo: false
merged_data_2019 <- merged_data %>%
  filter(Year == 2019) %>%
  filter(State != "ALL INDIA") %>%
  mutate(mutate(across(-c(State, Year), as.numeric)))

merged_data_2019_clean <- merged_data_2019 %>%
  filter(!is.na(`NSDP`), !is.na(`Health Expenditure`))  %>%
  filter(!State %in% c("Arunachal Pradesh")) %>%
  arrange(State)

# Preparing the add of the population variable by merging
Pop_data_2019 <- Pop_data_2019 %>%
  filter(!State %in% c("ANDAMAN & NICOBAR ISLANDS", "CHANDIGARH", "DNH", "TAMIL NADU")) %>%
  arrange(State)

# Merging
merged_data_2019_clean <- merged_data_2019_clean %>%
  mutate(Population = Pop_data_2019$total_population)
```

To work around this hypothesis, we have carefully selected six states representing different geographic directions of India. These states — Maharashtra (Central), Karnataka (South), Odisha (East), Punjab (North), Rajasthan (North-west), and Assam (North-east) were chosen to capture the cultural, economic, and regional variations that define India’s complexity. By incorporating states from distinct regions, this analysis aims to provide a holistic overview of how factors such as literacy rates, economic output, and demographic indicators vary across the nation’s vast and heterogeneous landscape.

```{r,, results='hide'}
#| message: false
#| warning: false
#| echo: false
# Select 6 states w.r.t different geographical regions in India
selected_states <- c("Maharashtra", "Karnataka","Odisha", "Punjab", "Rajasthan", "Assam")

# Filter data for these states
Filter_data <- merged_data |> filter(State %in% selected_states) %>%
  filter(!is.na(NSDP))
```

```{r,, results='hide'}
#| message: false
#| warning: false
#| echo: false
Filter_data_2011 <- Filter_data %>%
  filter(Year == 2011) 

# Select specific columns for the hypothesis
Filter_data_2011 <- Filter_data_2011 %>% select(State, Year, NSDP, `Literacy Rate`, `Sex Ratio`, `Birth Rate`)

# Check the structure of the dataset
str(Filter_data_2011)

# Convert the observations to numeric 
Filter_data_2011 <- Filter_data_2011 |> 
  mutate(NSDP = as.numeric(NSDP), `Sex Ratio` = as.numeric(`Sex Ratio`), `Birth Rate` = as.numeric(`Birth Rate`),`Literacy Rate` = as.numeric(`Literacy Rate`) )
```
```{r}
#| message: false
#| warning: false
#| echo: false
# Display the table
kable(Filter_data_2011, caption = "Table: Selected States from Filtered Data (2011)")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")                                   # Center column headers and values
```

#### Generating a ggplot for the first base of the hypothesis i.e States with higher NSDP tend to have higher literacy rates.

This plot visually examines the relationship between Net State Domestic Product (NSDP) and Literacy Rate across six selected states in 2011, representing different regions of India. The analysis uses NSDP as a proxy for economic productivity and literacy rate as an indicator of education levels. The scatter plot, augmented by a regression line, highlights how higher NSDP values are associated with increased literacy rates.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = NSDP, y = `Literacy Rate`, color = State)) +
  geom_point(size = 1.5) +  
  geom_text(aes(label = State), vjust = -0.5, size = 2) + 
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between NSDP and Literacy Rate", y = "Literacy Rate (%)", x = "NSDP (in Crores)", color = "State") +
  scale_x_continuous(limits = c(min(Filter_data_2011$NSDP) , max(Filter_data_2011$NSDP))) +  # Ensure NSDP is in ascending order
  scale_y_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) , max(Filter_data_2011$`Literacy Rate`))) +  
  theme_minimal()  
```

#### Inference drawn from the graph:

1. Positive Relationship: The upward trend of the regression line confirms a positive association between NSDP and literacy rate. States with higher economic productivity, such as Maharashtra, also exhibit higher literacy rates, suggesting a link between economic output and educational attainment.
2.	Regional Variations: States like Maharashtra and Karnataka, with high NSDP, are positioned at the higher end of the literacy scale, while Assam and Rajasthan, with lower NSDP, show relatively lower literacy rates.
3.	Significance of Education: This positive correlation highlights the interplay between educational development and economic productivity.

#### Limitations of the analysis: 

1. While the analysis demonstrates correlation, causation cannot be inferred. Other socio-economic factors, such as industrialization, healthcare, urbanization, regional investment, and socio-economic policies might also influence the relationship.
2. Dataset: We need to include more states to strengthen the generalizability of the inference and, also focus on historically underrepresented regions like the Northeast for a more balanced perspective. Increasing the number of observations might improve statistical power and lead to a more conclusive result.

This graph serves as an effective starting point for understanding the connection between education and economic output, offering valuable insights into regional disparities and developmental opportunities across India.

```{r}
#| message: false
#| warning: false
#| echo: false

# Compute correlation
correlation <- cor(Filter_data_2011$NSDP, Filter_data_2011$`Literacy Rate`)

# Fit the linear regression model
model1 <- lm(`Literacy Rate` ~ NSDP, data = Filter_data_2011)
summary_model <- summary(model1)

# Extract key statistics from the regression
results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (NSDP)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                
    round(summary_model$coefficients[1, 1], 3),           
    round(summary_model$coefficients[2, 1], 6),           
    round(summary_model$r.squared, 3),                    
    round(summary_model$adj.r.squared, 3),                
    round(summary_model$coefficients[2, 4], 3)           
  )
)

kable(results_table, caption = "Summary of Correlation and Linear Regression Results")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  
  row_spec(0, align = "c")                                   
```
In this Table, we draw a correlation to determine the strength and direction of the linear relationship between two variables NSDP & Literacy Rate. Linear regression goes beyond correlation by modeling the relationship between the variables. It tries to explain how much the dependent variable (Literacy Rate) changes with the independent variable (NSDP).

#### Conclusion:
1.	Correlation: NSDP and Literacy Rate have a positive correlation (0.6818).
2.	Regression: The slope for NSDP is extremely small. Moreover, the relationship is not statistically significant as p-value > 0.05 (p-value = 0.136), meaning we cannot confidently assert that NSDP has a meaningful effect or a strong predictor of Literacy Rate.

Thus, while there is a visible positive relationship between NSDP and Literacy Rate for our observations, the regression analysis indicates that NSDP is not a statistically significant predictor of Literacy Rate. This suggests that other factors may be influencing Literacy Rate more strongly than NSDP alone.

---

Hypothesis 2.1: Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.

#### Generating a ggplot for Hypothesis 2.1: Literacy Rate and Sex Ratio
This graph visually examines the relationship between Literacy Rate (%) and Sex Ratio (females per 1,000 males) across six selected states in 2011.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = `Literacy Rate`, y = `Sex Ratio`, color = State)) +
  geom_point(size = 2) +  # Add points
  geom_text(aes(label = State), vjust = -0.5, size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between Sex Ratio and Literacy Rate", y = " Sex Ratio (‰)", x = "Literacy Rate (%)", color = "State") +
  scale_y_continuous(limits = c(min(Filter_data_2011$`Sex Ratio`) - 1, max(Filter_data_2011$`Sex Ratio`) + 1)) +  
  scale_x_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) - 1 , max(Filter_data_2011$`Literacy Rate`) + 1 )) +  #
  theme_minimal()  
```
While the hypothesis posited that higher literacy rates would be positively associated with improved sex ratios due to greater gender awareness and access to education, the graph reveals a slightly negative trend in the regression line, challenging our initial assumption.

#### Inference Drawn from the graph:

1.	Negative Correlation: Contrary to the hypothesis, the graph displays a negative slope, suggesting that states with higher literacy rates, tend to have slightly lower sex ratios compared to other states.
2.	Regional Variations: Odisha and Assam exhibit relatively higher sex ratios despite moderate literacy rates. States like Rajasthan and Punjab show low sex ratios alongside moderate literacy rates, indicating the influence of cultural and historical factors. For instance, Goli, Srinivas and Arora, Somya and Jain (2022), in their reserach _Patrilocality and Child Sex Ratios in India_ highlights the regional disparities and a lingering reason in historical male child preference in northern states, which has often led to skewed sex ratios due to practices like prenatal gender selection. ^[Goli, Srinivas and Arora, Somya and Jain, Neha, Patrilocality and Child Sex Ratios in India (February 10, 2022)]

#### Limitations of the analysis: 

1.	Small Sample Size: The analysis includes only six states, which limits the ability to generalize findings. Expanding the dataset to include all Indian states and union territories would improve statistical reliability.
2.	Multivariate Influence: The model considers only literacy rate, ignoring other potential factors affecting sex ratio, such as: Economic disparities (e.g., income inequality), Cultural norms (e.g., male child preference), Government interventions (e.g., Beti Bachao Beti Padhao) etc.
3.	Lag Effect: Literacy improvements may take time to translate into gender equity. The observed trend could reflect a lag between rising literacy rates and their impact on societal norms.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
correlation <- cor(Filter_data_2011$`Sex Ratio`, Filter_data_2011$`Literacy Rate`)

# Fit the linear regression model
model_sex_ratio <- lm(`Sex Ratio` ~ `Literacy Rate`, data = Filter_data_2011)
summary_model <- summary(model_sex_ratio)

results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (Literacy Rate)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                
    round(summary_model$coefficients[1, 1], 3),           
    round(summary_model$coefficients[2, 1], 6),           
    round(summary_model$r.squared, 3),                    
    round(summary_model$adj.r.squared, 3),                
    round(summary_model$coefficients[2, 4], 3)            
  )
)

kable(results_table, caption = "Summary of Correlation and Linear Regression Results for Sex Ratio and Literacy Rate")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")
```

In this Table, we analyze the correlation to determine the strength and direction of the linear relationship between Literacy Rate and Sex Ratio. 

#### Conclusion

1.	Correlation: Literacy Rate and Sex Ratio exhibit a weak negative correlation (-0.128). This indicates that, in 2011, as the Literacy Rate increased, the Sex Ratio (number of females per 1000 males) tends to decrease slightly, but the relationship is very weak.
2.	Regression: The slope for Literacy Rate is negative such that for every 1% increase in Literacy Rate, the Sex Ratio decreases by approximately 0.775 females per thousand males.
3.	No Statistical Significance: The p-value of 0.8087 for the regression slope indicates that the relationship between literacy rate and sex ratio is not statistically significant. Moreover, the R-squared value (0.016) shows that only 1.6% of the variation in Sex Ratio is explained by Literacy Rate, confirming the extremely weak explanatory power of this model.

From these results, we cannot conclude that Literacy Rate has any meaningful or statistically significant effect on Sex Ratio. While the negative correlation suggests a possible inverse relationship, the lack of statistical significance implies that this trend may not hold consistently or could be driven by other confounding factors.

---

2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.

#### Generating a ggplot for Hypothesis 2.2: Literacy Rate and Birth Rate
This graph visually examines the relationship between Literacy Rate (%) and Birth Rate (Number of live births per 1,000 people annually) across six selected states in 2011.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = `Literacy Rate`, y = `Birth Rate`, color = State)) +
  geom_point(size = 2) +  # Add points
  geom_text(aes(label = State), vjust = -0.5, size = 3) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between Literacy Rate and Birth Rate", y = " Birth Rate (%)", x = "Literacy Rate (%)", color = "State") +
  scale_y_continuous(limits = c(min(Filter_data_2011$`Birth Rate`) -3 , max(Filter_data_2011$`Birth Rate`)+3)) + 
scale_x_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) - 3, 
                              max(Filter_data_2011$`Literacy Rate`) + 3))  + 
  theme_minimal()  
```
#### Inference Drawn from the graph:

1.	Negative Correlation: The graph displays a negative slope, indicating an inverse relationship between Literacy Rate and Birth Rate. States with higher literacy rates tend to have lower birth rates, whereas states with lower literacy rates exhibit higher birth rates. This aligns with our hypothesis which states that higher literacy rates are associated with lower birth rates due to increased awareness, education, and access to family planning.
2.	Regional Variations: Maharashtra and Punjab, with relatively higher literacy rates, have lower birth rates. However, Rajasthan and Assam, with moderate literacy rates, show higher birth rates. This reflects regional disparities and the varying socio-economic and cultural factors that influence reproductive behavior across states as we talked about in Hypothesis 2.1.
3.	Reinforcement of Educational Impact: The trend suggests that education, represented by literacy rates, plays a significant role in reducing birth rates by promoting family planning and urbanization.
	
#### Limitations of the Analysis

1. Small Sample Size: The analysis includes only six states, which limits the ability to generalize findings across all Indian states. Including more states and multiple years of data could improve the robustness of the analysis.
2.	Univariate Model: The model considers only literacy rate as a predictor of birth rate, ignoring other critical factors such as: Economic conditions (e.g., per capita income), Healthcare access (e.g., maternal health services), Cultural norms (e.g., preference for larger families in rural areas).
3. Present state of affairs: The analysis is based on data from 2011. It does not account for changes over time, such as advancements in healthcare, increased urbanization, and improved access to education that may have further influenced birth rates in recent years.
4.	Lag Effect: The observed relationship might reflect a lag effect, where the impact of literacy improvements on birth rates takes time to manifest for states having higher birth rate even with moderate literacy rates.

The graph supports the hypothesis that higher literacy rates are associated with lower birth rates. Literacy is a critical driver of reduced birth rates, but it must be complemented by socio-economic and healthcare interventions for sustained impact.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
correlation_birth_rate <- cor(Filter_data_2011$`Birth Rate`, Filter_data_2011$`Literacy Rate`)

# Fit the linear regression model for Birth Rate and Literacy Rate
model_birth_rate <- lm(`Birth Rate` ~ `Literacy Rate`, data = Filter_data_2011)
summary_model_birth_rate <- summary(model_birth_rate)

# Extract key statistics from the regression
results_table_birth_rate <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (Literacy Rate)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation_birth_rate, 3),                             
    round(summary_model_birth_rate$coefficients[1, 1], 3),       
    round(summary_model_birth_rate$coefficients[2, 1], 6),        
    round(summary_model_birth_rate$r.squared, 3),                 
    round(summary_model_birth_rate$adj.r.squared, 3),             
    round(summary_model_birth_rate$coefficients[2, 4], 3)         
  )
)

kable(results_table_birth_rate, caption = "Summary of Correlation and Linear Regression Results for Birth Rate and Literacy Rate")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")
```
In this Table, we analyze the correlation to determine the strength and direction of the linear relationship between Literacy Rate and Birth Rate. 


#### Conclusion

1.	Correlation: Literacy Rate and Birth Rate exhibit a strong negative correlation (-0.889). This indicates that, in 2011, states with higher Literacy Rates tended to have significantly lower Birth Rates
2.	Regression: The slope for Literacy Rate is negative and significant. The slope (-0.6398) indicates that for a 1% increase in Literacy Rate, the Birth Rate decreases by 0.6398 percentage points on average. The p-value of 0.01776 for the regression slope is less than 0.05, indicating that the relationship between Literacy Rate and Birth Rate is statistically significant. Finally, the R-squared value (0.7905) shows that 79.05% of the variation in Birth Rate is explained by Literacy Rate, highlighting the strong ability of the model to explain this variation.

The analysis confirms the hypothesis that higher Literacy Rates are associated with lower Birth Rates. This suggests that education plays a crucial role in family planning, urbanization, and access to reproductive health services, which collectively lead to a decline in Birth Rates. The negative slope and statistically significant results support the idea that states with better educational outcomes tend to have lower fertility rates. Therefore, Education is an important tool for improving socio-economic outcomes and controlling population growth. However, expanding the analysis to include additional variables and a larger dataset would provide a more comprehensive understanding of the factors influencing the Birth Rate in India. 


Moreover, these results seem to be generalizable for all States and Union Territories (UT) in India, as demonstrated by the graph  and regression table below: 
```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
# Filter and ensure all columns are numeric where necessary
merged_data_2011 <- merged_data %>%
  filter(Year == 2011) %>%
  filter(State != "ALL INDIA") %>%
  mutate(mutate(across(-c(State, Year), as.numeric)))

merged_data_2011_clean <- merged_data_2011 %>%
  filter(!is.na(`Birth Rate`), !is.na(`Literacy Rate`))  


# Create the plot
ggplot(merged_data_2011_clean, aes(x = `Literacy Rate`, y = `Birth Rate`, color = State)) +
  geom_point(size = 1) + 
  geom_text(aes(label = State), vjust = -0.5, size = 2.5) +  
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  
  labs(title = "Correlation Between Literacy Rate and Birth Rate\nAcross All Indian States and Union Territories (2011)",
       y = "Birth Rate (%)",
       x = "Literacy Rate (%)") +
  scale_y_continuous(limits = c(min(merged_data_2011$`Birth Rate`) - 3,
                                max(merged_data_2011$`Birth Rate`) + 3)) + 
  scale_x_continuous(limits = c(min(merged_data_2011$`Literacy Rate`) - 3,
                                max(merged_data_2011$`Literacy Rate`) + 3)) + 
  theme_minimal() + 
  theme(legend.position = "none", 
        plot.title = element_text(hjust = 0.5)  
)
```


```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
correlation_birth_rate2 <- cor(merged_data_2011_clean$`Birth Rate`, merged_data_2011_clean$`Literacy Rate`)

# Fit the linear regression model for Birth Rate and Literacy Rate
model_birth_rate2 <- lm(`Birth Rate` ~ `Literacy Rate`, data = merged_data_2011_clean)
summary_model_birth_rate2 <- summary(model_birth_rate)

# Extract key statistics from the regression
results_table_birth_rate2 <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (Literacy Rate)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation_birth_rate2, 3),                             
    round(summary_model_birth_rate2$coefficients[1, 1], 3),       
    round(summary_model_birth_rate2$coefficients[2, 1], 6),        
    round(summary_model_birth_rate2$r.squared, 3),                 
    round(summary_model_birth_rate2$adj.r.squared, 3),             
    round(summary_model_birth_rate2$coefficients[2, 4], 3)         
  )
)

kable(results_table_birth_rate2, caption = "Summary of Regression Results for Birth Rate and Literacy Rate Across All States and Union Territories")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")
```

These findings show that the negative relationship between Literacy Rate and Birth Rate holds across India's diverse socio-economic and geographic landscape. The larger dataset reinforces the importance of literacy and education in shaping demographic outcomes and highlights the need for targeted policies to address regional disparities and promote sustainable development.


# IV) Conclusion



---

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
text <- readLines("Report_Project_RBI.qmd")

# Identify code chunk boundaries
in_chunk <- grepl("^```", text)
chunk_flag <- cumsum(in_chunk) %% 2 == 1

# Keep only lines outside of code chunks
text_filtered <- text[!chunk_flag]

# Count words in the remaining lines
word_count <- sum(sapply(strsplit(text_filtered, "\\s+"), length))
```
The number of words in the report is `r word_count`.^[To count the words, we excluded all words that are part of the code (inside code chunks). Hence, the word count does not include words within tables, graphs, or any other elements generated through code.]