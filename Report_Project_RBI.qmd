---
title: "Investigating the Interplay Between Socio-Demographic Indicators and Net State Domestic Product (NSDP) Across Indian States"
author: "Aashish Sukhija & Eliot Lepetit"
format: 
  html: default
  pdf: default
editor: 
  markdown: 
    wrap: sentence
---


```{r}
#| message: false
#| warning: false
#| echo: false
here::i_am("Project_RBI.Rproj")
library(here)       
library(readxl)     
library(tidyr)  
library(stringr)
library(dplyr)
library(vroom)
library(readr)
library(knitr)
library(ggplot2)
library(janitor)
library(purrr)
theme_set(theme_bw())
```

```{r}
#| echo: false
suppressMessages({
Literacy_data <- read.csv(here("data", "State-wise_Literacy_Rate.csv"))
Birth_data <- read.csv(here("data", "State-wise_Birth_Rate.csv"))
Sex_data <- read.csv(here("data", "State-wise_Sex_Ratio.csv"))
Death_data <- read.csv(here("data", "State-wise_Death_Rate.csv"))
Pop_data <- read.csv(here("data", "State-wise_Total_Population.csv"))
IMR_data <- read.csv(here("data", "State-wise_Infant_Mortality_Rate.csv"))
TFR_data <- read.csv(here("data", "State-wise_Total_Fertility_Rate.csv"))
Life_data <- read.csv(here("data", "State-wise_Life_Expectancy.csv"))
Health_Exp_data <- read.csv(here("data", "State-wise_Public_Expenditure_on_Health.csv"))
NSDP1_data <- read.csv(here("data", "Net_State_Domestic_Product_1.csv"))
NSDP2_data <- read.csv(here("data", "Net_State_Domestic_Product_2.csv"))
NSDP3_data <- read.csv(here("data", "Net_State_Domestic_Product_3.csv"))
}) 
```


# I) Research Question
India’s diversity in economic and social conditions makes it an ideal case for studying the interplay between economic and demographic factors. High-performing states benefit from robust health and education systems, while underperforming states struggle due to insufficient investments in human capital. Moreover, understanding the impact of cultural and geographic differences adds a unique layer to the analysis. For instance, northeastern states may face challenges due to geographic isolation, while southern states may excel due to better health and education policies. Hence, our project aims to investigate the intricate relationship between socio-demographic indicators and economic performance at the state level in India.

**How do socio-demographic indicators, such as literacy rate, health expenditure, and birth rate, interact with the Net State Domestic Product (NSDP) across Indian states, and how do these interactions explain regional disparities in economic and social development?:**

To address this research question, we propose two sets of hypotheses which aim to uncover key drivers of regional disparities and shed light on the connections between economic performance and social development across Indian states.


## Hypotheses

#### Block 1: Health Expenditure and NSDP
1. States with higher NSDP allocate greater health expenditure per capita due to higher fiscal capacity.
   
   1.1. Higher health expenditure is associated with lower infant mortality rates and lower death rates.

#### Block 2: Literacy Rate and NSDP
2. States with higher NSDP tend to have higher literacy rates. Literacy is used as a proxy for education in this analysis.
  
   2.1. Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.
  
   2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.
   
This hypothesis is supported by extensive literature. For instance, Frank Götmark and Malte Andersson, in their article _Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs_, demonstrate that 'fertility (TFR) correlates negatively with education^[Götmark, F., Andersson, M. Human Fertility in Relation to Education, Economy, Religion, Contraception, and Family Planning Programs. BMC Public Health, 20, 265 (2020).]'. 


## Objectives of the Research

To summarize, this project aims to explore the relationship between socio-demographic indicators and economic performance across Indian states, focusing on:

1. **Regional Disparities**:
   - Analyze differences in NSDP across states and identify factors driving these disparities.

2. **Role of Socio-Demographic Indicators**:
   - Investigate the correlation between NSDP and variables like literacy rates, health expenditure, and birth/death rates.

3. **Regional Comparisons**:
   - Examine how geographic and cultural factors shape economic and social outcomes.

To achieve these objectives, we rely on datasets that provide insights into both socio-demographic factors and economic performance across Indian states.


# II) Data sets desctiption

## Data Sources
1. [Handbook of Statistics on Indian States](https://www.rbi.org.in/Scripts/AnnualPublications.aspx?head=Handbook+of+Statistics+on+Indian+States)
2. [Net State Domestic Product - State-wise (At Constant Prices)](https://www.rbi.org.in/Scripts/PublicationsView.aspx?id=22480)
 
---

### 1. Socio-Demographic Indicators
The socio-demographic data is sourced from the Handbook of Statistics on Indian States (2022-2023) by the Reserve Bank of India. This dataset provides insights into health, education, and population dynamics across India’s 28 states and 8 Union territories.

**Key Indicators:**
- Literacy Rate: Proportion of the population aged 7+ who can read and write.
- Birth Rate: Number of live births per 1,000 people annually.
- Death Rate: Number of deaths per 1,000 people annually.
- Sex Ratio: Number of females per 1,000 males.
- Total Population: Census-based state population projections.
- Infant Mortality Rate (IMR): Infant deaths per 1,000 live births.
- Total Fertility Rate (TFR): Average number of children per woman.
- Life Expectancy: Average years a person is expected to live.
- Public Health Expenditure: State-level spending on healthcare.

These indicators provide a socio-demographic lens to explore human development and its interaction with economic growth.


### 2. Net State Domestic Product (NSDP)
The NSDP data is derived from the RBI’s State-wise Economic Indicators. It reflects state-level economic output at constant prices, allowing comparisons over time by adjusting for inflation.

**Key Features:**
- Measures total economic value generated within each state.
- Disaggregated by sectors: agriculture, industry, and services.
- Organized by fiscal years to track growth trajectories.

NSDP serves as a benchmark for economic performance, offering insights into regional disparities and the structural composition of state economies.


## Why These Datasets?
These datasets are ideal for studying the interplay between socio-demographic factors and economic performance. While NSDP highlights economic output, socio-demographic indicators provide context for human capital and health conditions. Together, they allow for a robust analysis of regional disparities, uncovering patterns and trends that drive development outcomes across Indian states.


```{r}
#| message: false
#| warning: false
#| echo: false

# State-wise Birth Rate
Birth_data <- Birth_data %>%  rename(State = State.Union.Territory ) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>% 
    slice(-c(39, 40)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Death Rate
Death_data <- Death_data %>%  rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(39, 40)) %>%
   mutate(across(where(is.numeric), ~ round(., 1))) #rounding the data to one decimal place

# State-wise Public Expenditure on Health
Health_Exp_data <- Health_Exp_data %>%
  rename(State = `State.Union.Territory`) %>%                   
  rename_with(~ gsub("^X|\\..*", "", .)) %>%                     
  mutate(across(-State, as.numeric)) %>%                        
  mutate(across(where(is.numeric), ~ round(., 1))) %>%           
  slice(-c(37, 38))                                             

# State-wise Literacy Rate
Literacy_data <- Literacy_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(across(where(is.numeric), ~ round(., 1))) %>%
  slice(-c(37:40))

# State-wise Total Population
Pop_data <- Pop_data %>% rename(State = `State.Union.Territory`) %>%
        rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:43)) %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .)))

# State-wise Sex Ratio
Sex_data <- Sex_data %>% rename(State = `State.Union.Territory`) %>%
      rename_with(~ sub("^X", "", .)) %>%
  slice(-c(37:39))  %>%
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  select(-`1951`)  

# State-wise Total Fertility Rate
TFR_data <- TFR_data %>%  rename(State = `Year`) %>%
    rename_with(~ sub("^X", "", .)) %>%
    mutate(across(-State, as.numeric)) %>%
  slice(-c(24:26)) %>%
   mutate(across(where(is.numeric), ~ round(., 1)))

# Infant Mortality Rate
IMR_data <- IMR_data %>%
  row_to_names(row_number = 1) %>%
  slice(-c(38:41)) %>%
  rename(State = `State/Union Territory`) %>%
  mutate(across(-State, ~ as.numeric(gsub("\\*", "", .))))

```


```{r}
#| message: false
#| warning: false
#| echo: false
NSDP_merged <- NSDP1_data %>%
  full_join(NSDP2_data, by = "Year") %>%
  full_join(NSDP3_data, by = "Year")

# Removing unused rows (we keep the data only for years after 2011)
NSDP_merged <- NSDP_merged[c(11:16, 25:29, 38:44, 53:65), ] 

# Transforming missing values character as "NAs" and changing the dates format
NSDP_merged <- NSDP_merged %>% 
  mutate(across(everything(), ~ ifelse(. == "-", NA, .))) %>%
  mutate(Year = as.numeric(sub("-.*", "", Year)))

# We pivot the database to have a variable "State" in order to merge with other datasets
NSDP_long <- NSDP_merged %>%
  mutate(across(-Year, as.character)) %>%
  pivot_longer(
    cols = -Year,         
    names_to = "State",    
    values_to = "Value"     
  ) 

# Clean and arrange the State variable in alphabetical order and replace specific names
NSDP_clean <- NSDP_long %>%
  pivot_wider(
    names_from = Year,     
    values_from = Value
  )  %>%
  mutate(across(-State, as.numeric)) %>%
  mutate(
    State = gsub("\\.+", " ", State),                        # Replace "." with " "
    State = case_when(
      State == "Andaman Nicobar Islands" ~ "Andaman & Nicobar Islands", # Fix specific name
      State == "Jammu Kashmir" ~ "Jammu & Kashmir",                     # Fix Jammu Kashmir
      TRUE ~ State                                                    # Keep other names as is
    )
  ) %>%
  arrange(State)  # Sort by State in alphabetical order

rm(NSDP1_data, NSDP2_data, NSDP3_data)

```


```{r}
#| message: false
#| warning: false
#| echo: false
datasets <- list(
  Literacy_data, Birth_data, Sex_data, Death_data, Pop_data, Health_Exp_data, NSDP_clean, TFR_data, IMR_data
)

# Names of the datasets
dataset_names <- c(
  "Literacy Rate", "Birth Rate", "Sex Ratio", "Death Rate", "Population", "Health Expenditure", 
  "NSDP", "Total Fertility Rate", "Infant Mortality Rate"
)

# Preprocessing function
preprocess_dataset <- function(data) {
  data %>%
    {if (any(grepl("State", colnames(.)))) rename(., State = starts_with("State")) else .} %>% # Rename State if it exists
    rename_with(~ gsub("^X", "", .), -State) %>%    # Remove "X" prefix from year columns
    {if ("1951" %in% colnames(.)) select(., -`1951`) else .} %>% # Remove "1951" if it exists
    mutate(across(-State, as.character))           # Ensure all year columns are character
}

# Apply preprocessing to all datasets
datasets <- map(datasets, preprocess_dataset)

# Convert each dataset to long format
long_datasets <- map2(datasets, dataset_names, function(data, name) {
  data %>%
    pivot_longer(
      cols = -State,                
      names_to = "Year",           
      values_to = name              
    ) %>%
    mutate(Year = as.numeric(Year)) 
})

# Merge all long-format datasets by "State" and "Year"
merged_data <- reduce(long_datasets, full_join, by = c("State", "Year"))
```


After merging all the datasets, we observed missing values across certain years, as not all demographic variables are consistently available for every year in the RBI datasets. To address this, we selected specific years for each hypothesis: **2019** for the first and **2011** for the second.


<div style="display: flex; justify-content: space-between;">

<div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2019 <- merged_data %>%
  filter(State != "ALL INDIA") %>%
  filter(Year == 2019) %>%
  select(State, Year, NSDP, `Health Expenditure`, `Death Rate`, `Birth Rate`, `Infant Mortality Rate`) %>%
  head(5)

knitr::kable(table_2019, caption = "Data for Hypothese 1", align = "c")
```
</div> <div style="width: 48%;">

```{r}
#| message: false
#| warning: false
#| echo: false
table_2011 <- merged_data %>%
  filter(Year == 2011) %>%
  select(State, Year, NSDP, `Literacy Rate`, `Birth Rate`, `Sex Ratio`, `Death Rate`, `Infant Mortality Rate`) %>%
  head(5)

knitr::kable(table_2011, caption = "Data for Hypothese 2", align = "c")
```

</div> </div>

# Block 2 Hypothesis 
2. States with higher NSDP tend to have higher literacy rates. Literacy is used as a proxy for education in this analysis.
  
   2.1. Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.
  
   2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.
  
```{r}
#| message: false
#| warning: false
#| echo: false
merged_data_2011 <- merged_data %>%
  filter(Year == 2011) %>%
  filter(!is.na(NSDP)) #We remove the NAs for NSDP
```
To work around this hypothesis, we have carefully selected six states representing different geographic directions of India. These states — Maharashtra (Central), Karnataka (South), Odisha (East), Punjab (North), Rajasthan (North-west), and Assam (North-east) were chosen to capture the cultural, economic, and regional variations that define India’s complexity. By incorporating states from distinct regions, this analysis aims to provide a holistic overview of how factors such as literacy rates, economic output, and demographic indicators vary across the nation’s vast and heterogeneous landscape.
```{r,, results='hide'}
#| message: false
#| warning: false
#| echo: false
# Select 6 states w.r.t different directions in India
selected_states <- c("Maharashtra", "Karnataka","Odisha", "Punjab", "Rajasthan", "Assam")

# Filter data for these states
Filter_data_2011 <- merged_data_2011 |> filter(State %in% selected_states)
```



```{r, results='hide'}
#| message: false
#| warning: false
#| echo: false
# Check the data structure
str(Filter_data_2011)

# Inspect Literacy Rate and NSDP values
Filter_data_2011 |> select(State, NSDP, "Literacy Rate", "Sex Ratio", "Birth Rate")
```
```{r, results='hide'}
#| message: false
#| warning: false
#| echo: false
# Remove rows with NA values from every variable
Filter_data_2011 <- Filter_data_2011 |> 
  filter(!is.na(`Literacy Rate`), !is.na(NSDP), !is.na(`Sex Ratio`), !is.na(`Birth Rate`))
```

```{r, results='hide'}
#| message: false
#| warning: false
#| echo: false
# Check the structure of the dataset
str(Filter_data_2011)

# Convert NSDP to numeric if necessary
Filter_data_2011 <- Filter_data_2011 |> 
  mutate(NSDP = as.numeric(NSDP), `Sex Ratio` = as.numeric(`Sex Ratio`), `Birth Rate` = as.numeric(`Birth Rate`),`Literacy Rate` = as.numeric(`Literacy Rate`) )
```
```{r}
#| message: false
#| warning: false
#| echo: false
library(dplyr)
# Select specific columns by name
selected_columns <- Filter_data_2011 %>%
  select(State, Year ,`Literacy Rate`, `Birth Rate`, `Sex Ratio`, `NSDP`)  # Replace with your actual column names

# Display the table
library(knitr)
library(kableExtra)

kable(selected_columns, caption = "Table: Selected States from Filtered Data (2011)")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")                                   # Center column headers and values
```

#### Plotting a ggplot for the first base of the hypothesis i.e States with higher NSDP tend to have higher literacy rates.

This plot visually examines the relationship between Net State Domestic Product (NSDP) and Literacy Rate across six selected states in 2011, representing different regions of India. The analysis uses NSDP as a proxy for economic productivity and literacy rate as an indicator of education levels. The scatter plot, augmented by a regression line, highlights how higher NSDP values are associated with increased literacy rates.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = NSDP, y = `Literacy Rate`, color = State)) +
  geom_point(size = 1.5) +  # Add points
  geom_text(aes(label = State), vjust = -0.5, size = 2) +  # Label states above points
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between NSDP and Literacy Rate", y = "Literacy Rate (%)", x = "NSDP (in Crores)", color = "State") +
  scale_x_continuous(limits = c(min(Filter_data_2011$NSDP) , max(Filter_data_2011$NSDP))) +  # Ensure NSDP is in ascending order
  scale_y_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) , max(Filter_data_2011$`Literacy Rate`))) +  # Ensure ascending Literacy Rate
  theme_minimal()  # Use a clean theme
```

#### Inference drawn from the graph:

1. Positive Relationship: The upward trend of the regression line confirms a positive association between NSDP and literacy rate. States with higher economic productivity, such as Maharashtra, also exhibit higher literacy rates, suggesting a link between economic output and educational attainment.
2.	Regional Variations: States like Maharashtra and Karnataka, with high NSDP, are positioned at the higher end of the literacy scale, while Assam and Rajasthan, with lower NSDP, show relatively lower literacy rates.
3.	Significance of Education: This positive correlation highlights the interplay between educational development and economic productivity.

#### Limitations of the analysis: 

1. While the analysis demonstrates correlation, causation cannot be inferred. Other socio-economic factors, such as industrialization, healthcare, urbanization, regional investment, and socio-economic policies might also influence the relationship.
2. Dataset: We need to include more states to strengthen the generalizability of the inference and, also focus on historically underrepresented regions like the Northeast for a more balanced perspective. Increasing the number of observations might improve statistical power and lead to a more conclusive result.

This graph serves as an effective starting point for understanding the connection between education and economic output, offering valuable insights into regional disparities and developmental opportunities across India.

```{r}
#| message: false
#| warning: false
#| echo: false
library(dplyr)
library(knitr)

# Compute correlation
correlation <- cor(Filter_data_2011$NSDP, Filter_data_2011$`Literacy Rate`)

# Fit the linear regression model
model1 <- lm(`Literacy Rate` ~ NSDP, data = Filter_data_2011)
summary_model <- summary(model1)

# Extract key statistics from the regression
results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (NSDP)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                # Correlation coefficient
    round(summary_model$coefficients[1, 1], 3),           # Intercept
    round(summary_model$coefficients[2, 1], 6),           # Slope
    round(summary_model$r.squared, 3),                    # R-squared
    round(summary_model$adj.r.squared, 3),                # Adjusted R-squared
    round(summary_model$coefficients[2, 4], 3)            # p-value for the slope
  )
)

# Display the table
kable(results_table, caption = "Summary of Correlation and Linear Regression Results")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")                                   # Center column headers and values
```
In this Table, we draw a correlation to determine the strength and direction of the linear relationship between two variables NSDP & Literacy Rate. Linear regression goes beyond correlation by modeling the relationship between the variables. It tries to explain how much the dependent variable (Literacy Rate) changes with the independent variable (NSDP).

#### Conclusion:
1.	Correlation: NSDP and Literacy Rate have a moderate positive correlation (0.6818).
2.	Regression: The slope for NSDP is nonzero but very small. The slope indicates the change in Literacy Rate by 0.000009821 for a one-unit increase in NSDP. The slope is not statistically significant as p-value > 0.05 (p-value = 0.136), meaning we cannot confidently assert that NSDP has a meaningful effect or a strong predictor of Literacy Rate.

While there is a visible positive relationship between NSDP and Literacy Rate, the regression analysis indicates that NSDP is not a statistically significant predictor of Literacy Rate. This suggests that other factors may be influencing Literacy Rate more strongly than NSDP alone.



Hypothesis 2.1: Higher literacy rates are positively associated with improved sex ratios due to greater gender awareness and access to education.

#### Plotting a ggplot for Hypothesis 2.1: Literacy Rate and Sex Ratio
This graph visually examines the relationship between Literacy Rate (%) and Sex Ratio (females per 1,000 males) across six selected states in 2011.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = `Literacy Rate`, y = `Sex Ratio`, color = State)) +
  geom_point(size = 2) +  # Add points
  geom_text(aes(label = State), vjust = -0.5, size = 3) +  # Label states above points
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between Sex Ratio and Literacy Rate", y = " Sex Ratio (%)", x = "Literacy Rate (%)", color = "State") +
  scale_y_continuous(limits = c(min(Filter_data_2011$`Sex Ratio`) - 1, max(Filter_data_2011$`Sex Ratio`) + 1)) +  # Ensure Sex Ratio is in ascending order
  scale_x_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) - 1 , max(Filter_data_2011$`Literacy Rate`) + 1 )) +  # Ensure ascending Literacy Rate
  theme_minimal()  # Use a clean theme
```
While the hypothesis posited that higher literacy rates would be positively associated with improved sex ratios due to greater gender awareness and access to education, the graph reveals a slightly negative trend in the regression line, challenging the initial assumption.

#### Inference Drawn from the graph:

1.	Negative Correlation: Contrary to the hypothesis, the graph displays a negative slope, suggesting that states with higher literacy rates, such as Maharashtra, tend to have slightly lower sex ratios compared to states like Odisha and Assam, which have higher sex ratios and moderate literacy rates.
2.	Regional Variations: Odisha and Assam exhibit relatively higher sex ratios despite moderate literacy rates. States like Rajasthan and Punjab show low sex ratios alongside moderate literacy rates, indicating the influence of cultural and historical factors. This highlights the regional disparities and a lingering reason in historical male child preference in northern states, which has often led to skewed sex ratios due to practices like prenatal gender selection. It is possible that if we look at the present data, results we see could be different. For instance, Sarkar, P., & Das, A. (2020), in their reserach _Gender Equality and Education in India: Exploring Regional Differences_ ^[Sarkar, P., & Das, A. (2020). Gender Equality and Education in India: Exploring Regional Differences. Social Indicators Research. DOI: 10.1007/s11205-020-02309-w.].

#### Limitations of the analysis: 

1.	Small Sample Size: The analysis includes only six states, which limits the ability to generalize findings. Expanding the dataset to include all Indian states and union territories would improve statistical reliability.
2.	Multivariate Influence: The model considers only literacy rate, ignoring other potential factors affecting sex ratio, such as: Economic disparities (e.g., income inequality), Cultural norms (e.g., male child preference), Government interventions (e.g., Beti Bachao Beti Padhao) etc.
3.	Lag Effect: Literacy improvements may take time to translate into gender equity. The observed trend could reflect a lag between rising literacy rates and their impact on societal norms.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
# Compute correlation
correlation <- cor(Filter_data_2011$`Sex Ratio`, Filter_data_2011$`Literacy Rate`)

# Fit the linear regression model
model_sex_ratio <- lm(`Sex Ratio` ~ `Literacy Rate`, data = Filter_data_2011)
summary_model <- summary(model_sex_ratio)

# Extract key statistics from the regression
results_table <- data.frame(
  Statistic = c("Correlation Coefficient", "Intercept", "Slope (Literacy Rate)", "R-squared", "Adjusted R-squared", "p-value"),
  Value = c(
    round(correlation, 3),                                # Correlation coefficient
    round(summary_model$coefficients[1, 1], 3),           # Intercept
    round(summary_model$coefficients[2, 1], 6),           # Slope
    round(summary_model$r.squared, 3),                    # R-squared
    round(summary_model$adj.r.squared, 3),                # Adjusted R-squared
    round(summary_model$coefficients[2, 4], 3)            # p-value for the slope
  )
)

# Display the table
kable(results_table, caption = "Summary of Correlation and Linear Regression Results for Sex Ratio and Literacy Rate")  %>%
  kable_styling(position = "center", full_width = FALSE) %>%  # Center the table
  row_spec(0, align = "c")
```

In this Table,
We analyze the correlation to determine the strength and direction of the linear relationship between Literacy Rate and Sex Ratio. Linear regression provides deeper insights by modeling this relationship, attempting to explain how much the dependent variable (Sex Ratio) changes with the independent variable (Literacy Rate).

#### Conclusion

1.	Correlation: Literacy Rate and Sex Ratio exhibit a weak negative correlation (-0.128). This indicates that, in 2011, as the Literacy Rate increased, the Sex Ratio (number of females per 1000 males) tends to decrease slightly, but the relationship is very weak.
2.	Regression: The slope for Literacy Rate is nonzero but negative and very small. The slope (-0.775) indicates that for a 1% increase in Literacy Rate, the Sex Ratio decreases by 0.775 on average.
3.	No Statistical Significance: The p-value of 0.8087 for the regression slope indicates that the relationship between literacy rate and sex ratio is not statistically significant. Thus, the observed trend cannot be confidently attributed to a causal relationship. The R-squared value (0.016) shows that only 1.6% of the variation in Sex Ratio is explained by Literacy Rate, confirming the weak explanatory power of this model.

From these results, We cannot conclude that Literacy Rate has any meaningful or statistically significant effect on Sex Ratio. While the negative correlation suggests a possible inverse relationship, the lack of statistical significance implies that this trend may not hold consistently or could be driven by other confounding factors.

2.2. Higher literacy rates are positively associated with lower birth rates due to urbanization, education, and access to family planning.

#### Plotting a ggplot for Hypothesis 2.2: Literacy Rate and Birth Rate
This graph visually examines the relationship between Literacy Rate (%) and Birth Rate (Number of live births per 1,000 people annually) across six selected states in 2011.

```{r, fig.align="center"}
#| message: false
#| warning: false
#| echo: false
ggplot(Filter_data_2011, aes(x = `Literacy Rate`, y = `Birth Rate`, color = State)) +
  geom_point(size = 2) +  # Add points
  geom_text(aes(label = State), vjust = -0.5, size = 3) +  # Label states above points
  geom_smooth(method = "lm", formula = y ~ x, color = "red", se = FALSE) +  # Add regression line
  labs( title = "Relationship Between Literacy Rate and Birth Rate", y = " Birth Rate (%)", x = "Literacy Rate (%)", color = "State") +
  scale_y_continuous(limits = c(min(Filter_data_2011$`Birth Rate`) -3 , max(Filter_data_2011$`Birth Rate`)+3)) +  # Ensure Birth Rate is in ascending order
scale_x_continuous(limits = c(min(Filter_data_2011$`Literacy Rate`) - 3, 
                              max(Filter_data_2011$`Literacy Rate`) + 3))  + theme_minimal()  # Use a clean theme
```


```{r}
cor(Filter_data_2011$`Birth Rate`, Filter_data_2011$`Literacy Rate`) #  correlation coefficient between two variables
# Linear regression
model1 <- lm( `Birth Rate` ~ `Literacy Rate`, data = Filter_data_2011)
summary(model1)
```
we find:-
	The coefficient (-0.8891) indicates a strong negative correlation:
	•	As the Literacy Rate increases, the Birth Rate tends to decrease significantly.
	•	This aligns with theories suggesting higher literacy rates are associated with lower birth rates due to factors like education, urbanization, and access to family planning
	
	•	For every 1% increase in Literacy Rate, the Birth Rate decreases by 0.6398 births per 1000 people.
	•	The negative slope supports the hypothesis that higher literacy rates are associated with lower birth rates.
	•	Statistically significant (p-value = 0.01776 < 0.05), meaning we have strong evidence that Literacy Rate influences Birth Rate.
	
		1.	Correlation: A strong negative correlation exists between Birth Rate and Literacy Rate (-0.8891).
	2.	Regression:
	•	The model confirms that higher Literacy Rates are associated with lower Birth Rates.
	•	The effect is statistically significant (p-value = 0.01776).
	•	The model explains a large portion of variability in Birth Rate (R-squared = 79.05%).
	
	Conclusion

The results provide strong evidence to support the hypothesis that higher literacy rates are associated with lower birth rates. This aligns with social and economic theories that suggest education improves awareness and access to family planning, contributing to reduced fertility rates.

